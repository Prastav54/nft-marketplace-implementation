import{w as S,au as x,al as C,af as U,av as M,aw as k,ax as z,ay as D,az as I,aA as O}from"./index-ClxLoTQ8.js";function R(w){if(w.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),v=0;v<n.length;v++)n[v]=255;for(var p=0;p<w.length;p++){var c=w.charAt(p),A=c.charCodeAt(0);if(n[A]!==255)throw new TypeError(c+" is ambiguous");n[A]=p}var l=w.length,E=w.charAt(0),u=Math.log(l)/Math.log(256),T=Math.log(256)/Math.log(l);function m(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length===0)return"";for(var t=0,g=0,a=0,i=e.length;a!==i&&e[a]===0;)a++,t++;for(var s=(i-a)*T+1>>>0,r=new Uint8Array(s);a!==i;){for(var h=e[a],f=0,o=s-1;(h!==0||f<g)&&o!==-1;o--,f++)h+=256*r[o]>>>0,r[o]=h%l>>>0,h=h/l>>>0;if(h!==0)throw new Error("Non-zero carry");g=f,a++}for(var d=s-g;d!==s&&r[d]===0;)d++;for(var y=E.repeat(t);d<s;++d)y+=w.charAt(r[d]);return y}function b(e){if(typeof e!="string")throw new TypeError("Expected String");if(e.length===0)return new Uint8Array;for(var t=0,g=0,a=0;e[t]===E;)g++,t++;for(var i=(e.length-t)*u+1>>>0,s=new Uint8Array(i);e[t];){var r=n[e.charCodeAt(t)];if(r===255)return;for(var h=0,f=i-1;(r!==0||h<a)&&f!==-1;f--,h++)r+=l*s[f]>>>0,s[f]=r%256>>>0,r=r/256>>>0;if(r!==0)throw new Error("Non-zero carry");a=h,t++}for(var o=i-a;o!==i&&s[o]===0;)o++;for(var d=new Uint8Array(g+(i-o)),y=g;o!==i;)d[y++]=s[o++];return d}function N(e){var t=b(e);if(t)return t;throw new Error("Non-base"+l+" character")}return{encode:m,decodeUnsafe:b,decode:N}}var q=R;const F=q,B="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var _=F(B);const V=S(_);class $ extends x{async authenticateUser(){var n;if(!this.provider||!((n=this.chainConfig)!==null&&n!==void 0&&n.chainId))throw C.notConnectedError();const{chainNamespace:v,chainId:p}=this.chainConfig;if(this.status!==U.CONNECTED)throw C.notConnectedError("Not connected with wallet, Please login/connect first");const c=await this.provider.request({method:"getAccounts"});if(c&&c.length>0){const A=M(c[0],this.name);if(A&&!k(A))return{idToken:A};const l={domain:window.location.origin,uri:window.location.href,address:c[0],chainId:parseInt(p,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},E=await z(l,v),u=new TextEncoder().encode(E),T=await this.provider.request({method:"signMessage",params:{message:u,display:"utf8"}}),m=await D(v,V.encode(T),E,this.name,this.sessionTime);return I(c[0],this.name,m),{idToken:m}}throw C.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnect(){if(this.status!==U.CONNECTED)throw C.disconnectionError("Not connected with wallet");const n=await this.provider.request({method:"getAccounts"});n&&n.length>0&&O(n[0],this.name)}}export{$ as B};
