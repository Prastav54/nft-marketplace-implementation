import{u as C,a as b,b as g,j as t,M as E,h as j,S as f,c as N,d as U,r as d,g as I}from"./index-R8wq8AXP.js";import{u as v,U as B,M as F}from"./GraphQueries-DFKYM47q.js";const T=n=>{const{marketplaceAddress:o,marketplaceAbi:c,narutoAddress:s}=C(),{runContractFunction:a}=b({abi:c,contractAddress:o,functionName:"cancelNftListing",params:{nftAddress:s,tokenId:n}});return{cancelNft:a}};function R({isVisible:n,setIsVisible:o,tokenId:c}){const{cancelNft:s}=T(c),a=()=>{o(!1)},r=g(),i=async l=>{await l.wait(1),r({type:f,message:"NFT Cancelled from marketplace. Please refresh your page",title:N,position:"topR"}),a()};return t.jsx(E,{isVisible:n,onCancel:a,title:"Cancel NFT",onCloseButtonPressed:a,isCentered:!0,onOk:()=>{s({onError:l=>j(l,r),onSuccess:l=>i(l)})},children:t.jsx("p",{children:t.jsx("b",{children:"Are You sure want to remove this NFT from marketplace ?"})})})}const O=(n,o)=>{const{marketplaceAddress:c,marketplaceAbi:s,narutoAddress:a}=C(),{runContractFunction:r}=b({abi:s,contractAddress:c,functionName:"buyNft",msgValue:o,params:{nftAddress:a,tokenId:n}});return{buyNft:r}},L=()=>{const{data:n,refetch:o}=v(F),{account:c}=U(),[s,a]=d.useState({}),[r,i]=d.useState(!1),[l,m]=d.useState(!1),p=g(),{buyNft:k}=O(s==null?void 0:s.tokenId,s==null?void 0:s.price),u=d.useMemo(()=>n==null?void 0:n.nftDescriptions,[n]),x=e=>e===c,y=async e=>{await e.wait(1),p({type:f,message:"NFT Bought Successfully",title:N,position:"topR"}),o(),a({})},S=async e=>{await e.wait(1),p({type:f,message:"NFT Price Updated.",title:N,position:"topR"}),o(),h()};d.useEffect(()=>{s.price&&s.tokenId&&!x(s.owner)&&k({onError:e=>j(e,p),onSuccess:e=>y(e)})},[s]);const A=e=>{a(e)},h=()=>{a({}),i(!1)},M=e=>{a(e),i(!0)},w=e=>{a(e),m(!0)};return t.jsxs("div",{className:"bg-[#04123C] overflow-auto h-[89vh] pt-4 px-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10 rounded",children:u!=null&&u.length?u.map(e=>t.jsxs("div",{className:"h-[300px] w-[250px] mt-3",children:[t.jsx("img",{id:`image-${e.id}`,src:I(e.tokenUrl,`image-${e.id}`),className:"h-full w-full object-cover rounded-md",alt:"No Image"}),t.jsx("br",{}),x(e.owner)?t.jsxs("div",{className:"flex",children:[t.jsx("button",{className:"text-[#04123C] font-semibold bg-[#808B96] px-8 rounded-2xl py-2",onClick:()=>M(e),children:"Update"}),t.jsx("button",{className:"text-[#04123C] font-semibold bg-[#808B96] px-8 ml-2 rounded-2xl py-2",onClick:()=>w(e),children:"Cancel"})]}):t.jsx("button",{className:"text-[#04123C] font-semibold bg-[#808B96] px-8 rounded-2xl py-2",onClick:()=>A(e),children:"Buy"}),t.jsx("br",{})]},e.id)):t.jsx("div",{className:"grid place-items-center",children:t.jsx("b",{className:"text-[#ffff]",children:"No List Found"})})}),t.jsx(B,{isVisible:r,tokenId:s.tokenId,defaultPrice:s.price,onClose:h,handleSuccess:S}),t.jsx(R,{isVisible:l,setIsVisible:m,tokenId:s.tokenId})]})};export{L as ListNft};
